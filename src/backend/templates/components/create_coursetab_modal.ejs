<!-- Open the modal using ID.showModal() method -->
<button class="btn" onclick="coursetabmodal.showModal()">add</button>
<dialog id="coursetabmodal" class="modal">
  <div class="modal-box">
    <h3 class="font-bold text-lg">Add Course Tab</h3>

    <label class="label">
        <span class="label-text">Tab Name</span>
    </label>
    <input id="tabname" type="text" placeholder="Tab" class="input input-bordered w-full" name="<%= courseId %>" required>
    <button id="add-tab" type="submit" class="btn btn-primary w-full">Add</button>

  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>


<script>
  const addButton = document.getElementById("add-tab");
  const tabName = document.getElementById("tabname");
  const courseTabs = document.getElementById("course-tabs");

  addButton.addEventListener("click", async () => {
      try{
          const courseId = tabName.getAttribute("name");
          const payload = await fetch("/create/coursetab", {
              method: "POST",
              headers: {
                  "Content-Type": "application/json"
              },
              body: JSON.stringify({
                  "tabName": tabName.value,
                  "courseId": courseId
              })
          });

          if (!payload.ok)
            throw Exception;

          //Add to the menu
          console.log("1");
          const li = document.createElement("li");
          console.log("2");
          li.className = "menu-item mb-2 draggable-item p-2 cursor-pointer";
          console.log("3");
          const a = document.createElement("a");
          console.log("4");
          a.href = "/" + tabName;
          console.log("5");
          li.appendChild(a);
          console.log("6");
          console.log("here!");
          courseTabs.appendChild(li);

      } catch (error) {
        console.log("error: ", error);
      }
  });
</script>